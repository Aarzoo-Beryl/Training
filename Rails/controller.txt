<--------------------------------------Action Controller------------------------------------------------>

Controller - acts as as a middleman between the models (data) and views (presentation).
    - Role in MVC:
        - refers to "c" in the MVC architecture
        - handles the request and response of the application

    - Request Handling:
        - browser decides to which controller the request should be sent
        - it receives the request from the user
        - processes the request
        - sends the response to the user

    - Fetching and Saving Data:
        - controller is responsible for fetching and saving data
        - it interacts with the model to fetch data from the database
        - it saves or update data to the model which turn saves or updates it to the database

    - Rendering Views:
        - after getting the necessary data  
        - controller is responsible for rendering views
        - it renders the view based on the request
        - it passes the data to the views

    - Naming Convention:
        - controller name must be with pluralized last words (e.g., ClientsController instead of ClientController)
        - this naming convention helps in using default route generators (like resources) without extra configurations
        - models are named in singular form (e.g., Client)

    - Methods and Actions:
        - controllers are Ruby classes that inherit from ApplicationController, which in turn inherits from ActionController::Base
        - methods in controllers correspond to actions. For example, a request to /clients/new will call the new method in ClientsController
        - methods like "new" can create instance variables (e.g., @client = Client.new) to be used in views
        - if a method is empty, Rails will render the corresponding view (e.g., new.html.erb) by default
        - only public methods can be called as actions others should be marked as private or protected
        - some method names are reserved by Action Controller,using these as action names can cause errors

Creating a controller - 
        - $ rails generate controller User
        - this will create a controller named UserController in the app/controllers directory
        - name should be capital and singular
        - this command does the following work - 
                - creates file called user_controller.rb
                - this file inherits from ActionController::Base class
        - you can define any no of methods in the controller

Implementing list method - list method provied you with all the books present in the database
        - can be done simply like - 
              def list
                @users = user.all
              end
        - this tells the rails to search the books table and store each row it finds in the instance object

Implemention show method - displays further details on a single user
        - can be done like -  
              def show
                @user = User.find(params[:id])
              end
        - this tells the rails to search the books table and store each row it finds in the instance
        - tells rails to find only the book with the specified with id 

Implementing new Method - allows rails to know that you want to create a new object
          - can be done like -
                def new
                  @user = User.new
                end
          - above method will be called when you display a page to the user to take user inputs

Implementing create method - once users input is taken using html form, you need to create a record into the database
          - can be done like -
                def create
                  @user = User.new(user_params)
                  if @user.save
                    redirect_to @user
                  else
                    render 'new'
                  end
                end
                def user_params
                  params.require(:books).permit(:name, :phone_number, :email, :username,:password, :location, :profile_picture)
                end
          - above method will be called when you submit the form to the server
          - user_params is a method that is used to filter the user input fields 
          - if the user input is valid, it will be saved into the database and the user will be redirected to the show page
          - if the user input is invalid, it will be rendered again to the new page

Implementing edit method - it is almost identical to the show method but is used to display a single object with particualr id  and display it on the page
          - only diff. is that show method is not editable
          - can be done like - 
                def edit
                  @user = User.find(params[:id])
                end
          - this method will be called to display data on the screen to be modified by the user
          - it will be called when the user clicks on the edit button

Implementing update method - this method will be called after the edit method, when the changes made by the user needs to be updated in the database
          - it is similar to create and will be used to update the existing users in the database
          - can be done like -
                def update
                  @user = User.find(params[:id])
                  if @user.update(user_params)
                    redirect_to @user
                  else
                    render 'edit'
                  end
                end
          - this method will be called when the user clicks on the update button
          - if the user input is valid, it will be saved into the database and the user will be redirected to the show page
          - if the user input is invalid, it will be rendered again to the edit page
          - update method is similar to the save used by create but instead of creating a new row in the db, it overrights the attributes of the existing row

Implementing delete method - used to display the record used is attempting to delete and the final delition will be made by destroy methods only
          - doen't trigger any callbacks or validations
          - can be done like -
                def delete
                  @user = User.find(params[:id])
                end      

Implementing destroy method - used to delete a record from database 
          - it triggers callbacks and well as checks validations like dependent 
          - can be done like -
                  def destroy
                    @user = User.find(params[:id])
                    @user.destroy
                    redirect_to users_path
                  end
          - this method will be called when the user clicks on the delete button
          - it will delete the record from the database and redirect the user to the index page




















Parameters - can be of two types basically

    - Query String - sent as a part of url 
        - everything in url after "?"
        - used in GET request
        - can be accessed using params[:attribute]

    - POST Data - sent as a part of request body
        - used in POST request
        - called POST data as can only be sent on the form of HTTP POST request
        - eg - creating new client by filling out a form

    - Array paramenters - 
        - put key name and empty "[]"
          eg - GET clients? id[]=1& id[]=2& id[]=3

    - Hash paramenters - 
        - when we fill a form and the values are passed to model as 
          { "name" => "Acme", "phone" => "12345", "address" => { "postcode" => "12345", "city" => "Carrot City" } }

    - JSON paramenters - 
        - in rails handeling parameters in Json format , some automatic processes and configurations take place that simplify how you access these parameters within your controller
        - Automatic Paramter Passing - when you pass a JSON object to a controller action, Rails will automatically convert the JSON into a Ruby hash 
                and assign it to the params hash
                eg - if you sen the Json content - { "company": { "name": "acme", "address": "123 Carrot Street" } }
                     then ccontroller will receive params[:company] as { "name" => "acme", "address" => "123 Carrot Street" }

        - Wrap Parameters - wrap_parameters can automatically wrap your parameters with a root element based on your controller's name
                to call wrap parameter directly in your controller ,  either use ->wrap_parameters :company, format: [:json] or enable it in config/initializers/wrap_parameters.rb as
                ActiveSupport.on_load(:action_controller) do
                  wrap_parameters format: [:json]
                end

    - Routing paramenters - params hash contains :controller and :action keys
        - should instead use methods controller_name and action_name to access them
        - any other parameter associcated will also be available
        - eg - get '/clients/:status', to: 'clients#index', foo: 'bar'
          # when a user visits /clients/active:
            - :status parameter in the URL (/clients/:status) will be captured => params[:status] will be "active"
            - rails will set params[:controller] to "clients" and params[:action] to "index"
            - any extra parameters specified in the route (like foo: 'bar') will also be added to the params hash => params[:foo] = "bar"
            - to access them do variable = params[:action]

    - Composite key paramenters - contains multiple values in one parameter
        - now in this we need to be able to access each value and pass them to Active Record
        - we can use extact_value method for this
        - fro urls like /book/4_2 keys ["4","2"] can be accessed as id=params.extact_value(:id)

    - Strong paramenters - helps tosecurely handle mass asignment of parameters preventing accidently or maliciously modifying sesitive data
        - to use strong parameters we need to use the permit method
        - eg - params.permit(:name, :email, :phone)
        - this will allow only the specified parameters to be passed to the model
        - to allow all parameters we can use params.permit!
        - to allow only the specified parameters and their children we can use params.permit(:name,:email, :phone, :address => [:postcode, :city])
    - Default URL option - this refers to setting of global parameter for the url generation by defining a method callled default_url_options in your control
        - this method returns hash with desired defaults , whose keys must be symbols 
        - these options will beused as a starting point when generatinf urls, so its possible they'll be overridden by the options assed to url_for calls
        - when we define default_url_options in ApplicationController as -
            def default_url_options(options = {})
            { locale: I18n.locale }
            end
          these defaults will be used for all URL generations
        - this method can also be defined in a specific controller in which case it only affects the urls generated however


